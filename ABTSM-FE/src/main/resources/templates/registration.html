
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		
		<title>Advanced Base Transceiver Station Manager</title>
		
		<!-- Bootstrap Core CSS -->
		<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
		
		<!-- MetisMenu CSS -->
		<link href="vendor/metisMenu/metisMenu.min.css" rel="stylesheet"/>
		
		<!-- Custom CSS -->
		<link href="dist/css/sb-admin-2.css" rel="stylesheet"/>
		
		<!-- Custom Fonts -->
		<link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
		
		<!-- chat-bot css -->
		<link rel="stylesheet" href="css/style.css" />
	</head>

	<body>
		<!-- Navigation -->
	<nav class="navbar navbar-default navbar-static-top" role="navigation"
		style="margin-bottom: 0">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse"
				data-target=".navbar-collapse">
				<span class="icon-bar"></span> <span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/home">ABTMS</a>
		</div>

		<ul class="nav navbar-top-links navbar-right">
			<li><a href="#chatbotModal" data-toggle="modal"
				data-target="#chatbotModal"><i class="fa">chatbot</i></a></li>
			<li class="dropdown"><a class="dropdown-toggle"
				data-toggle="dropdown" href="#"> <i class="fa fa-user fa-fw"></i>
					<i class="fa fa-caret-down"></i>
			</a>
				<ul class="dropdown-menu dropdown-user">
					<li><a href="#"><i class="fa fa-user fa-fw"></i> User
							Profile</a></li>
					<li><a href="#"><i class="fa fa-gear fa-fw"></i> Settings</a></li>
					<li class="divider"></li>
					<li><a href="login.html"><i class="fa fa-sign-out fa-fw"></i>
							Logout</a></li>
				</ul>
			</li>
		</ul>

		<div class="navbar-default sidebar" role="navigation">
			<div class="sidebar-nav navbar-collapse">
				<ul class="nav" id="side-menu">
					<li><a href="/home"><i class="fa fa-bar-chart-o fa-fw"></i>BTS<span
							class="fa arrow"></span></a>
						<ul class="nav nav-second-level">
							<li><a href="/home">Search</a></li>
							<li><a href="/registration">Registration</a></li>
						</ul></li>
					<li><a href="/about"><i class="fa fa-files-o fa-fw"></i>About</a></li>
				</ul>
			</div>
		</div>
	</nav>
		
		<div id="page-wrapper">
			<div class="row">
				<div class="col-lg-12">
					<h1 class="page-header">BTS 위치 정보 등록</h1>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-12">
					<div class="panel panel-default">
						<div class="panel-heading">BTS 위치 정보</div>
						<div class="panel-body">
							<div class="row">
								<div class="col-lg-6">
									<!-- 등록 FORM  -->
									<form class="form-horizontal">
										<div class="form-group">
										    <label for="input_bts_id" class="col-sm-2 control-label">BTS-ID</label>
										    <div class="col-sm-8">
										      <input type ="text" class="form-control" id="input_bts_id"/>
										    </div>
										    <div class="col-sm-2">
										      <div class="btn btn-default" id="btn_id_chk" onclick="onCheckId()">중복조회</div>
										    </div>
									  	</div>
									  	
									  	<div class="form-group">
									  		<label for="sample2_postcode" class="col-sm-2 control-label">우편번호</label> 
									  		<div class="col-sm-8">
										    		<input type ="text" class="form-control" id="sample2_postcode"/>
										    	</div>
										    	<div class="col-sm-2">
												<div class="btn btn-default" id="btn_find_post" onclick="sample2_execDaumPostcode()">우편번호 찾기</div>
										    	</div>
									  	</div>	
									  	
									  	<div class="form-group">
									  		<label for="sample2_address" class="col-sm-2 control-label">주소</label> 
									  		<div class="col-sm-10">
										    		<input type ="text" class="form-control" id="sample2_address"/>
										    	</div>
										    	<div id="layer" style="display: none; position: fixed; overflow: hidden; z-index: 1; -webkit-overflow-scrolling: touch;">
												<img src="images/close.png" id="btnCloseLayer" style="cursor: pointer; position: absolute; right: -3px; top: -3px; z-index: 1" onclick="closeDaumPostcode()" alt="닫기 버튼"/>
											</div>
									  	</div>
									  	
									  	<div class="form-group">
									  		<label for="sample2_address" class="col-sm-2 control-label">상세주소</label> 
									  		<div class="col-sm-10">
										    		<input type ="text" class="form-control" id="sample2_address2"/>
										    	</div>
									  	</div>
										  <div class="form-group">
										    <div class="col-sm-offset-2 col-sm-10">
												<button type="reset" class="btn btn-default">초기화</button>
												<button type="submit" class="btn btn-primary">등록</button>
										    </div>
										  </div>
									</form>
									
								</div>
								<!-- /.col-lg-6 (nested) -->
								<div class="col-lg-6"></div>
								<!-- /.col-lg-6 (nested) -->
							</div>
							<!-- /.row (nested) -->
						</div>
						<!-- /.panel-body -->
					</div>
					<!-- /.panel -->
				</div>
				<!-- /.col-lg-12 -->
			</div>
			<!-- /.row -->
		</div>
		<!-- /#page-wrapper -->
		
			<!-- Modal -->
	<div class="modal fade" id="chatbotModal" tabindex="-1" role="dialog"
		aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body custom-height-modal">
					<!--sticky-->
					<div class="row no-border">
						<div class="sixteen wide tablet eight wide computer column"
							style="text-align: center"></div>
					</div>
					<!-- chatting window start -->
					<div id="chatbotwrapper" class="chatbotwrap"
						style="height: 90%; width: 90%;"></div>

					<!-- chatting window end -->
				</div>
			</div>
		</div>
	</div>
		


		<!-- jQuery -->
		<script src="vendor/jquery/jquery.min.js"></script>

		<!-- Bootstrap Core JavaScript -->
		<script src="vendor/bootstrap/js/bootstrap.min.js"></script>

		<!-- Metis Menu Plugin JavaScript -->
		<script src="vendor/metisMenu/metisMenu.min.js"></script>
		
			<!-- js 추가(chat-bot) -->
	<script src="js/app2.min.js"></script>
	<script src="js/loading.min.js"></script>
		
		<script src="http://dmaps.daum.net/map_js_init/postcode.v2.js"></script>
		
		<!-- 우편번호조회 -->
		<script>
		// 우편번호 찾기 화면을 넣을 element
		var element_layer = document.getElementById('layer');
		
		function closeDaumPostcode() {
			// iframe을 넣은 element를 안보이게 한다.
			element_layer.style.display = 'none';
		}
		
		function sample2_execDaumPostcode() {
			new daum.Postcode(
					{
						oncomplete : function(
								data) {
							// 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.
		
							// 각 주소의 노출 규칙에 따라 주소를 조합한다.
							// 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
							var fullAddr = data.address; // 최종 주소 변수
							var extraAddr = ''; // 조합형 주소 변수
		
							// 기본 주소가 도로명 타입일때 조합한다.
							if (data.addressType === 'R') {
								//법정동명이 있을 경우 추가한다.
								if (data.bname !== '') {
									extraAddr += data.bname;
								}
								// 건물명이 있을 경우 추가한다.
								if (data.buildingName !== '') {
									extraAddr += (extraAddr !== '' ? ', '
											+ data.buildingName
											: data.buildingName);
								}
								// 조합형주소의 유무에 따라 양쪽에 괄호를 추가하여 최종 주소를 만든다.
								fullAddr += (extraAddr !== '' ? ' ('
										+ extraAddr
										+ ')'
										: '');
							}
		
							// 우편번호와 주소 정보를 해당 필드에 넣는다.
							document
									.getElementById('sample2_postcode').value = data.zonecode; //5자리 새우편번호 사용
							document
									.getElementById('sample2_address').value = fullAddr;
							document
									.getElementById('sample2_addressEnglish').value = data.addressEnglish;
		
							// iframe을 넣은 element를 안보이게 한다.
							// (autoClose:false 기능을 이용한다면, 아래 코드를 제거해야 화면에서 사라지지 않는다.)
							element_layer.style.display = 'none';
						},
						width : '100%',
						height : '100%',
						maxSuggestItems : 5
					}).embed(element_layer);
		
			// iframe을 넣은 element를 보이게 한다.
			element_layer.style.display = 'block';
		
			// iframe을 넣은 element의 위치를 화면의 가운데로 이동시킨다.
			initLayerPosition();
		}
		
		// 브라우저의 크기 변경에 따라 레이어를 가운데로 이동시키고자 하실때에는
		// resize이벤트나, orientationchange이벤트를 이용하여 값이 변경될때마다 아래 함수를 실행 시켜 주시거나,
		// 직접 element_layer의 top,left값을 수정해 주시면 됩니다.
		function initLayerPosition() {
			var width = 380; //우편번호서비스가 들어갈 element의 width
			var height = 456; //우편번호서비스가 들어갈 element의 height
			var borderWidth = 0; //샘플에서 사용하는 border의 두께
		
			// 위에서 선언한 값들을 실제 element에 넣는다.
			element_layer.style.width = width
					+ 'px';
			element_layer.style.height = height
					+ 'px';
			element_layer.style.border = borderWidth
					+ 'px solid';
			// 실행되는 순간의 화면 너비와 높이 값을 가져와서 중앙에 뜰 수 있도록 위치를 계산한다.
			element_layer.style.left = (((window.innerWidth || document.documentElement.clientWidth) - width) / 2 - borderWidth)
					+ 'px';
			element_layer.style.top = (((window.innerHeight || document.documentElement.clientHeight) - height) / 2 - borderWidth)
					+ 'px';
		}
		</script>
		
		<!--중복조회-->
		<script>
		/*<![CDATA[*/
			function onCheckId(){
				var btsId = $('#input_bts_id')[0].value;
				$.ajax({
				  type: "GET",
				  url: "/bts/chkBtsId/"+btsId,
				  success: function(data, textStatus, jqXHR){
					  if(data.length<1){
						 alert("정상적으로 등록이 가능합니다.") 
					  }
					  else{
						alert("이미 등록된 아이디입니다.")
					  }
				  },
				  error: function(jqXHR, textStatus, errorThrown){
					  console.log(errorThrown);
					  console.log(textStatus);
					  console.log(jqXHR);
				  }
				});
			}
			/*]]>*/
		</script>
		
		
		<!--중복조회-->
		<script>
		/*<![CDATA[*/
			function registBfs(){
				var btsId = $('#input_bts_id')[0].value;
				$.ajax({
				  type: "POST",
				  url: "/bts/registration",
				  data:{
					"id":"test"  
				  },
				  success: function(data, textStatus, jqXHR){
					  console.log(data);
				  },
				  error: function(jqXHR, textStatus, errorThrown){
				  }
				});
			}
			/*]]>*/
		</script>
		
			<script>
		$(".btn[data-target='#myModal']")
				.click(
						function() {
							var columnHeadings = $("thead th").map(function() {
								return $(this).text();
							}).get();
							columnHeadings.pop();
							var columnValues = $(this).parent().siblings().map(
									function() {
										return $(this).text();
									}).get();
							var modalBody = $('<div id="modalContent"></div>');
							var modalForm = $('<form role="form" name="modalForm" action="index.html" method="post"></form>');
							$
									.each(
											columnHeadings,
											function(i, columnHeader) {
												var formGroup = $('<div class="form-group"></div>');
												formGroup
														.append('<label for="'+columnHeader+'">'
																+ columnHeader
																+ '</label>');
												formGroup
														.append('<input class="form-control" name="'+columnHeader+i+'" id="'+columnHeader+i+'" value="'+columnValues[i]+'" />');
												modalForm.append(formGroup);
											});
							modalBody.append(modalForm);
							$('.modal-body').html(modalBody);
						});
		$('.modal-footer .btn-primary').click(function() {
			$('form[name="modalForm"]').submit();
		});

		$(document).ready(function() {
			var table = $('#example').DataTable();

			$('#example tbody').on('click', 'tr', function() {
				if ($(this).hasClass('selected')) {
					$(this).removeClass('selected');
				} else {
					table.$('tr.selected').removeClass('selected');
					$(this).addClass('selected');
				}
			});

			$('#button').click(function() {
				table.row('.selected').remove().draw(false);
			});

		});
	</script>


	<script>
		function setMarker(a, b, title, html) {
			var marker;
			console.log(a + "  " + b);
			marker = new google.maps.Marker({
				map : map,
				position : new google.maps.LatLng(a, b),
				title : title
			});
			google.maps.event.addListener(marker, 'load', function() {
				infowindow.setContent(html);
				infowindow.open(map, marker);
				infowindow.setposition(event.LatLng)
			});
		}
	</script>


	<!-- google Maps API -->
	<script>
		var marker;
		var infowindow;
		var map;
		var markers = [];
		function initialize() {
			var myLatlng;

			myLatlng = new google.maps.LatLng(36.9960144, 127.958510);
			//var map;
			//var marker;
			console.log("--=----");
			//
			var mapOptions = {
				zoom : 7,
				center : myLatlng,
				mapTypeId : google.maps.MapTypeId.ROADMAP

			};

			map = new google.maps.Map(document.getElementById('map-canvas'),
					mapOptions);

			var contentString = '<p style="line-height: 20px;">Place</p><p>Number</p>';

			var infowindow = new google.maps.InfoWindow({
				content : contentString
			});

			marker = new google.maps.Marker({
				position : myLatlng,
				map : map,
				title : 'Marker'
			});
			google.maps.event.addListener(marker, 'click', function() {
				infowindow.open(map, marker);
			});
			marker.setMap(null);
		}

		//google.maps.event.addDomListener(window, 'load', initialize);
	</script>

	<!-- event function  -->
	<script>
		//my button event 함수 
		$(".panel-default.map").on(
				"click",
				"._my",
				function(url) {
					$.ajax({
						method : "GET",
						url : '/bts/my',
						success : function(data) {
							console.log(data[0] + " / " + data[0].ssid + " "
									+ data[0].latitude + " "
									+ data[0].longitude);
							setMarker(data[0].latitude, data[0].longitude,
									data[0].streetAddress,
									data[0].secondaryUnit);
							setMarker(data[1].latitude, data[1].longitude,
									data[1].streetAddress,
									data[1].secondaryUnit);
							setMarker(data[2].latitude, data[2].longitude,
									data[2].streetAddress,
									data[2].secondaryUnit);
							setMarker(data[3].latitude, data[3].longitude,
									data[3].streetAddress,
									data[3].secondaryUnit);
						}
					});
				});
		//page onload

		var entry = $('.data-table-entry');

		$(document).ready(
				function(url) {
					//google.maps.event.addDomListener(window, 'load', initialize); 
					initialize();
					var Latlng;

					$.ajax({
						method : "GET",
						url : '/bts/my',

						success : function(data) {

							/*<![CDATA[*/
							for (var i = 0; i < data.length; i++) {
								/*]]>*/
								setMarker(data[i].latitude, data[i].longitude,
										data[i].streetAddress,
										data[i].secondaryUnit);
								var str = ' <tr><td>' + data[i].ssid
										+ '</td><td>' + data[i].latitude
										+ '</td><td>' + data[i].longitude
										+ '</td><td>' + data[i].streetAddress
										+ ' </td><td>' + data[i].secondaryUnit
										+ '</td><td>' + data[i].modifyDate
										+ '</td></tr> ';
								entry.append(str);

							}

						}
					});
				});
	</script>


	<script>
		/* 함수명 고정(수정불가) */
		/*chat-bot */

		function process(result) {
			var s = ""; //초기화

			//무응답 처리
			if (result.output.text.length == 0) {
				s = "대화모델에 해당 입력에 대한 응답이 없습니다. 대화 모델을 확인 해 주세요."
			} else {
				if (result.output.type == "Link") { //DB 또는 API 연동시
					/*<![CDATA[*/
					for (var i = 0; i < result.output.text[0].result.length; i++) {
						s += "<img src='" + result.output.text[0].result[i] + "' width='50' height='30'>"
					}
				} else { //일반 대화시
					for ( var key in result.output.text) {
						s += result.output.text[key];
						s += "<br />";
					}
				}
			}
			/*]]>*/
			var time = new Date(Date.now());
			var option = {
				hour : "2-digit",
				minute : "2-digit"
			};
			var timeStamp = time.toLocaleTimeString("en-US", option);

			$("#style-3")
					.append(
							"<div class='talk_isac'><div class='talk_isac_box'>"
									+ s
									+ "</div><div class='talk_isac_time'>"
									+ timeStamp
									+ "</div><div class='talk_isac_icon'><span class='glyphicon glyphicon-headphones' aria-hidden='true'></span></div></div>");

			$("#style-3").append("<div class='clear'></div>");
		}
	</script>

	<script type="text/javascript">
		$(document).ready(function() {
			$('#chatbotwrapper').OEngine({
				//width   :  '100%',
				//height  :  '560px',
				//bgColor :  '#efefef',
				//ctitle  :  "Aibril Chatbot",
				firstMsg : "안녕하세요. Aibril Chatbot 입니다.",
				api_key : "fb7da8f3-ec06-4320-9bac-21206322f4fe"
			});
		});
	</script>
		
		
	</body>	
</html>
